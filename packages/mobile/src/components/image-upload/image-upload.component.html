<div class="image-upload-container">
  <!-- ä¸Šä¼ åŒºåŸŸ -->
  <div 
    class="upload-area"
    [class.drag-over]="dragOver"
    [class.uploading]="isUploading"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave($event)"
    (drop)="onDrop($event)"
    (click)="fileInput.click()"
  >
    <input
      #fileInput
      type="file"
      multiple
      [accept]="acceptedTypes.join(',')"
      (change)="onFileSelected($event)"
      style="display: none;"
    />

    <div class="upload-content" *ngIf="!isUploading">
      <i class="upload-icon">ğŸ“</i>
      <p class="upload-text">{{ placeholder }}</p>
      <p class="upload-hint">æ”¯æŒ {{ acceptedTypes.join(', ') }} æ ¼å¼</p>
      <p class="upload-hint">æœ€å¤§ {{ formatFileSize(maxFileSize) }}ï¼Œæœ€å¤š {{ maxFiles }} ä¸ªæ–‡ä»¶</p>
    </div>

    <div class="upload-progress" *ngIf="isUploading">
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="uploadProgressValue"></div>
      </div>
      <p class="progress-text">æ­£åœ¨å¤„ç†å›¾ç‰‡... {{ uploadProgressValue }}%</p>
    </div>
  </div>

  <!-- æ–‡ä»¶åˆ—è¡¨ -->
  <div class="file-list" *ngIf="selectedFiles.length > 0">
    <div class="file-item" *ngFor="let file of selectedFiles; let i = index">
      <div class="file-preview" *ngIf="showPreview">
        <img [src]="getFilePreview(file)" [alt]="file.name" />
      </div>
      
      <div class="file-info">
        <div class="file-name">{{ file.name }}</div>
        <div class="file-size">{{ formatFileSize(file.size) }}</div>
        
        <!-- å‹ç¼©ä¿¡æ¯ -->
        <div class="compression-info" *ngIf="enableCompression && compressedFiles[i]">
          <div class="compression-stats">
            <span class="original-size">åŸå§‹: {{ formatFileSize(compressedFiles[i].originalSize) }}</span>
            <span class="compressed-size">å‹ç¼©: {{ formatFileSize(compressedFiles[i].compressedSize) }}</span>
            <span class="compression-ratio" [class.good]="compressedFiles[i].compressionRatio > 50">
              èŠ‚çœ: {{ compressedFiles[i].compressionRatio.toFixed(1) }}%
            </span>
          </div>
          
          <div class="compression-suggestion" *ngIf="getCompressionSuggestion(file).recommended">
            <i class="suggestion-icon">ğŸ’¡</i>
            <span class="suggestion-text">{{ getCompressionSuggestion(file).reason }}</span>
          </div>
        </div>
      </div>

      <div class="file-actions">
        <button 
          class="remove-btn" 
          (click)="removeFile(i)"
          title="åˆ é™¤æ–‡ä»¶"
        >
          âœ•
        </button>
      </div>
    </div>
  </div>

  <!-- å‹ç¼©ç»Ÿè®¡ -->
  <div class="compression-stats" *ngIf="enableCompression && compressedFiles.length > 0">
    <div class="stats-header">
      <h4>å‹ç¼©ç»Ÿè®¡</h4>
    </div>
    
    <div class="stats-content">
      <div class="stat-item">
        <span class="stat-label">æ€»æ–‡ä»¶æ•°:</span>
        <span class="stat-value">{{ compressedFiles.length }}</span>
      </div>
      
      <div class="stat-item">
        <span class="stat-label">åŸå§‹å¤§å°:</span>
        <span class="stat-value">{{ formatFileSize(getCompressionStats().totalOriginalSize) }}</span>
      </div>
      
      <div class="stat-item">
        <span class="stat-label">å‹ç¼©åå¤§å°:</span>
        <span class="stat-value">{{ formatFileSize(getCompressionStats().totalCompressedSize) }}</span>
      </div>
      
      <div class="stat-item">
        <span class="stat-label">èŠ‚çœç©ºé—´:</span>
        <span class="stat-value savings">{{ formatFileSize(getCompressionStats().totalSavings) }}</span>
      </div>
      
      <div class="stat-item">
        <span class="stat-label">å¹³å‡å‹ç¼©ç‡:</span>
        <span class="stat-value">{{ getCompressionStats().averageCompressionRatio.toFixed(1) }}%</span>
      </div>
    </div>
  </div>

  <!-- æ“ä½œæŒ‰é’® -->
  <div class="action-buttons" *ngIf="selectedFiles.length > 0">
    <button 
      class="btn btn-secondary" 
      (click)="clearFiles()"
    >
      æ¸…ç©ºæ‰€æœ‰
    </button>
    
    <button 
      class="btn btn-primary" 
      [disabled]="isUploading"
      (click)="filesCompressed.emit(compressedFiles)"
    >
      ç¡®è®¤ä¸Šä¼ 
    </button>
  </div>
</div>
